---
import { experience } from '../content/data/experience';
---
<div class="grid gap-8">
  <!-- Company Selector with Enhanced Styling -->
  <div class="flex flex-wrap justify-center gap-4">
    {experience.map((e,i)=>
      <button 
        class="company-btn relative group transition-all duration-300 bg-white/60 dark:bg-white/5 hover:bg-white/80 dark:hover:bg-white/10 border border-gray-200/60 dark:border-white/10 hover:border-brand-red/30 rounded-2xl px-4 py-3 font-semibold hover:shadow-lg hover:shadow-brand-red/10 active:scale-95"
        data-company={i}
        onclick={`showExperience(${i})`}
      >
        <span class="text-sm font-bold whitespace-nowrap">{e.company}</span>
        
        <!-- Tooltip -->
        <div class="company-tooltip absolute bottom-full left-1/2 transform -translate-x-1/2 mb-3 w-80 p-4 bg-white dark:bg-gray-800 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700 opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto transition-all duration-300 z-50">
          <div class="mb-3">
            <h4 class="font-bold text-lg text-gray-900 dark:text-white">{e.company}</h4>
            <p class="text-sm text-gray-500 dark:text-gray-400">{e.industry}</p>
          </div>
          <p class="text-sm text-gray-700 dark:text-gray-300 mb-2">{e.description}</p>
          <div class="flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400">
            <span class="flex items-center gap-1">
              <iconify-icon icon="solar:users-group-rounded-outline" class="w-3 h-3"></iconify-icon>
              {e.employees} employees
            </span>
            <span class="flex items-center gap-1">
              <iconify-icon icon="solar:case-outline" class="w-3 h-3"></iconify-icon>
              {e.industry}
            </span>
          </div>
          <!-- Tooltip arrow -->
          <div class="absolute top-full left-1/2 transform -translate-x-1/2 border-8 border-transparent border-t-white dark:border-t-gray-800"></div>
        </div>
      </button>
    )}
  </div>

  <!-- Experience Cards with Enhanced Styling -->
  <div class="relative">
    {experience.map((e,i)=>
      <div class={`exp-card transition-all duration-500 ${i>0?'hidden':''}`} data-index={i}>
        <div class="glass rounded-3xl p-8 border border-white/20 hover:border-brand-red/20 transition-all duration-300 hover:shadow-2xl hover:shadow-brand-red/5">
          <!-- Header with Company Info -->
          <div class="flex items-start justify-between mb-6">
            <div class="flex items-center gap-4">
              <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-brand-red/10 to-brand-red/5 flex items-center justify-center text-sm font-bold border border-brand-red/20 text-brand-red">
                {e.company.substring(0, 2).toUpperCase()}
              </div>
              <div>
                <h3 class="text-2xl font-bold text-gray-900 dark:text-white">{e.role}</h3>
                <p class="text-lg font-medium text-brand-red">{e.company}</p>
                <p class="text-sm text-gray-500 dark:text-gray-400">{e.industry} â€¢ {e.employees} employees</p>
              </div>
            </div>
            <div class="text-right">
              <span class="px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-xl text-sm font-medium text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-700">
                {e.date}
              </span>
            </div>
          </div>

          <!-- Key Achievements -->
          <div class="mb-6">
            <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2">
              <iconify-icon icon="solar:medal-star-outline" class="w-5 h-5 text-brand-red"></iconify-icon>
              Key Achievements
            </h4>
            <ul class="space-y-3">
              {e.bullets.map(b=>
                <li class="flex items-start gap-3 text-gray-700 dark:text-gray-300">
                  <iconify-icon icon="solar:check-circle-outline" class="w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"></iconify-icon>
                  <span>{b}</span>
                </li>
              )}
            </ul>
          </div>

          <!-- Technologies -->
          <div>
            <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2">
              <iconify-icon icon="solar:code-outline" class="w-5 h-5 text-brand-red"></iconify-icon>
              Technologies & Tools
            </h4>
            <div class="flex flex-wrap gap-2">
              {e.tags.map(t=>
                <span class="px-3 py-1 bg-gradient-to-r from-gray-100 to-gray-50 dark:from-gray-800 dark:to-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm font-medium border border-gray-200 dark:border-gray-600 hover:border-brand-red/30 transition-colors">
                  {t}
                </span>
              )}
            </div>
          </div>
        </div>
      </div>
    )}
  </div>
</div>

<script>
  let currentExperience = 0;

  function showExperience(index) {
    // Hide all cards
    document.querySelectorAll('.exp-card').forEach((card, i) => {
      card.classList.add('hidden');
    });
    
    // Show selected card
    const selectedCard = document.querySelector(`[data-index="${index}"]`);
    if (selectedCard) {
      selectedCard.classList.remove('hidden');
    }
    
    // Update button states
    document.querySelectorAll('.company-btn').forEach((btn, i) => {
      if (i === index) {
        btn.classList.add('bg-brand-red', 'text-white', 'border-brand-red');
        btn.classList.remove('bg-white/60', 'dark:bg-white/5', 'hover:bg-white/80', 'dark:hover:bg-white/10');
      } else {
        btn.classList.remove('bg-brand-red', 'text-white', 'border-brand-red');
        btn.classList.add('bg-white/60', 'dark:bg-white/5', 'hover:bg-white/80', 'dark:hover:bg-white/10');
      }
    });
    
    currentExperience = index;
  }

  // Initialize first company as active
  window.addEventListener('DOMContentLoaded', () => {
    showExperience(0);
  });

  // Make function globally available
  window.showExperience = showExperience;
</script>
